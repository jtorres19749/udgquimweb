"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3485],{3485:(j,g,l)=>{l.r(g),l.d(g,{LoginPageModule:()=>v});var p=l(177),n=l(4341),i=l(7863),u=l(8573),h=l(467),e=l(4438),f=l(8133);function b(o,s){if(1&o){const r=e.RV6();e.j41(0,"ion-card",9),e.nrm(1,"ion-img",10),e.j41(2,"ion-card-header")(3,"ion-card-subtitle",11),e.EFF(4," Aplicaci\xf3n para control escolar de la Universidad de Guadalajara, Licenciatura en Quimica. "),e.k0s()(),e.j41(5,"ion-card-content")(6,"form",12),e.bIt("ngSubmit",function(){e.eBV(r);const a=e.XpG();return e.Njj(a.submit(a.fg.value))}),e.j41(7,"div",13)(8,"ion-item"),e.nrm(9,"ion-input",14),e.k0s(),e.j41(10,"ion-item"),e.nrm(11,"ion-input",15),e.k0s()(),e.j41(12,"div",16)(13,"ion-button",17),e.EFF(14,"Entrar"),e.k0s()()()(),e.j41(15,"ion-footer"),e.nrm(16,"ion-spinner",18),e.k0s()()}if(2&o){const r=e.XpG();e.R7$(6),e.Y8G("formGroup",r.fg),e.R7$(7),e.Y8G("disabled",!r.fg.valid),e.R7$(2),e.xc7("visibility",r.isWaiting?"visible":"hidden")}}function k(o,s){if(1&o){const r=e.RV6();e.j41(0,"ion-card",19)(1,"ion-card-header")(2,"ion-card-title",11),e.EFF(3," Registro de usuario "),e.k0s(),e.j41(4,"ion-card-subtitle",11),e.EFF(5," Favor de capturar su username, nombre personal y password. "),e.k0s()(),e.j41(6,"ion-card-content")(7,"form",12),e.bIt("ngSubmit",function(){e.eBV(r);const a=e.XpG();return e.Njj(a.submitUsr(a.fge.value))}),e.j41(8,"div",13)(9,"ion-item"),e.nrm(10,"ion-input",20),e.k0s(),e.j41(11,"ion-item"),e.nrm(12,"ion-input",21),e.k0s(),e.j41(13,"ion-item"),e.nrm(14,"ion-input",22),e.k0s(),e.j41(15,"ion-item"),e.nrm(16,"ion-input",15),e.k0s(),e.j41(17,"ion-item"),e.nrm(18,"ion-input",23),e.k0s()(),e.j41(19,"div",16)(20,"ion-button",17),e.EFF(21,"Registrar"),e.k0s()()()()()}if(2&o){const r=e.XpG();e.R7$(7),e.Y8G("formGroup",r.fge),e.R7$(3),e.Y8G("readonly",!0),e.R7$(10),e.Y8G("disabled",!r.fg.valid)}}const P=[{path:"",component:(()=>{var o;class s{constructor(t,a,d,c){this.menuCtrl=t,this.fb=a,this.route=d,this.alertController=c,this.login=!0,this.bdService=(0,e.WQX)(f.RA),this.auth=(0,e.WQX)(f.Pt),this.isWaiting=!1,this.validations={username:[{type:"required",message:"Favor de introducir usuario o email"}],password:[{type:"minlength",message:"El password debe ser al menos de 8 caracteres."}]},this.fg=void 0,this.fge=void 0}ngOnInit(){this.auth.setIsLoggedIn(!1),this.fg=this.fb.group({username:new n.MJ("",n.k0.compose([n.k0.required])),password:new n.MJ("",n.k0.compose([n.k0.minLength(8)]))})}ionViewWillEnter(){this.menuCtrl.enable(!1)}submit(t){console.log(t);let a={email:t.username,password:btoa(t.password)};this.isWaiting=!0,this.bdService.login(a).then(d=>{this.isWaiting=!1,console.log(d);let c=atob(d.data);console.log(c);let m=JSON.parse(c)._doc;console.log(m),m.email?m.tmpid?this.startEditUser(m.email):(console.log("entro ok login"),this.auth.setIsLoggedIn(!0),this.auth.setIsAdmin(!!m.admin),this.route.navigate(["/","students"])):this.presentAlert("Usuario o password no reconocidos.")}).catch(d=>{this.isWaiting=!1,this.presentAlert("Usuario o password no reconocidos")})}startEditUser(t){this.login=!1,this.fge=this.fb.group({username:new n.MJ("",n.k0.compose([n.k0.required])),email:new n.MJ({value:t,disabled:!0},n.k0.compose([n.k0.required])),name:new n.MJ("",n.k0.compose([n.k0.required])),password:new n.MJ("",n.k0.compose([n.k0.minLength(8)])),password2:new n.MJ("",n.k0.compose([n.k0.minLength(8)]))})}submitUsr(t){console.log(t);let a={email:this.fge.get("email").value,password:btoa(t.password),name:t.name,username:t.username};console.log(a),this.bdService.saveuser(a).then(d=>{let c=atob(d.data);JSON.parse(c),this.login=!0})}presentAlert(t="",a="Login",d="",c=["Ok"]){var m=this;return(0,h.A)(function*(){yield(yield m.alertController.create({header:a,subHeader:d,message:t,buttons:c})).present()})()}}return(o=s).\u0275fac=function(t){return new(t||o)(e.rXU(i._t),e.rXU(n.ok),e.rXU(u.Ix),e.rXU(i.hG))},o.\u0275cmp=e.VBU({type:o,selectors:[["app-login"]],decls:17,vars:4,consts:[[1,"ion-no-border",3,"translucent"],[3,"fullscreen"],["collapse","condense"],["size","large"],["id","main"],["size","auto"],["size","10","size-sm","6","size-md","5","size-lg","3"],["id","cardlogin",4,"ngIf"],["id","cardupdateuser",4,"ngIf"],["id","cardlogin"],["id","logo","src","../../assets/img/LQUI-VERDE@300x.png","alt","UDG Quimica logo",1,"ion-text-center"],[1,"ion-text-center"],[3,"ngSubmit","formGroup"],[1,"wrapform"],["label","Usuario o correo","labelPlacement","stacked","type","text","name","username","formControlName","username","required","","placeholder","Usuario o correo"],["label","Password","labelPlacement","stacked","type","Password","name","password","formControlName","password","placeholder","***********"],[1,"sign-btn"],["type","submit","shape","round",3,"disabled"],["id","spinner","name","bubbles"],["id","cardupdateuser"],["label","Email","labelPlacement","stacked","type","text","name","email","formControlName","email","required","","placeholder","Email o correo",3,"readonly"],["label","Username o clave de usuario","labelPlacement","stacked","type","text","name","username","formControlName","username","required","","placeholder","Username o clave de usuario"],["label","Nombre","labelPlacement","stacked","type","text","name","name","formControlName","name","required","","placeholder","Nombre del usuario"],["label","Cofirme password","labelPlacement","stacked","type","Password","name","password2","formControlName","password2","placeholder","***********"]],template:function(t,a){1&t&&(e.j41(0,"ion-header",0),e.nrm(1,"ion-toolbar"),e.k0s(),e.j41(2,"ion-content",1)(3,"ion-header",2)(4,"ion-toolbar")(5,"ion-title",3),e.EFF(6,"login"),e.k0s()()(),e.j41(7,"div",4)(8,"ion-grid"),e.nrm(9,"ion-row"),e.j41(10,"ion-row",5),e.nrm(11,"ion-col"),e.j41(12,"ion-col",6),e.DNE(13,b,17,4,"ion-card",7)(14,k,22,3,"ion-card",8),e.k0s(),e.nrm(15,"ion-col"),e.k0s(),e.nrm(16,"ion-row"),e.k0s()()()),2&t&&(e.Y8G("translucent",!0),e.R7$(2),e.Y8G("fullscreen",!0),e.R7$(11),e.Y8G("ngIf",a.login),e.R7$(),e.Y8G("ngIf",!a.login))},dependencies:[p.bT,n.qT,n.BC,n.cb,n.YS,n.j4,n.JD,i.Jm,i.b_,i.I9,i.ME,i.HW,i.tN,i.hU,i.W9,i.M0,i.lO,i.eU,i.KW,i.$w,i.uz,i.ln,i.w2,i.BC,i.ai,i.Gw],styles:["ion-content[_ngcontent-%COMP%]{--ion-background-color: #e9ffea}ion-toolbar[_ngcontent-%COMP%]{--ion-background-color: transparent;--opacity: 0}ion-card-title[_ngcontent-%COMP%]{font-weight:600;margin-bottom:20px}ion-card-subtitle[_ngcontent-%COMP%]{margin-top:20px;margin-bottom:20px}ion-card[_ngcontent-%COMP%]{border:0!important;box-shadow:none!important;border:none!important;border-style:none!important;position:relative;text-align:center}.sign-btn[_ngcontent-%COMP%]{margin-top:30px;text-align:center}ion-button[_ngcontent-%COMP%]{--background: #006120;--ion-primary-color: #006120}#spinner[_ngcontent-%COMP%]{margin:20px;color:#006120;width:100px;height:100px}"]}),s})()}];let w=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[u.iI.forChild(P),u.iI]}),s})(),v=(()=>{var o;class s{}return(o=s).\u0275fac=function(t){return new(t||o)},o.\u0275mod=e.$C({type:o}),o.\u0275inj=e.G2t({imports:[p.MD,n.YN,n.X1,i.bv,w]}),s})()}}]);